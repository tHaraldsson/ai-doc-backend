# ========== SUPABASE DATABASE ==========
spring.r2dbc.url=${SUPABASE_DB_URL}&prepareThreshold=0&preparedStatementCacheQueries=0&preparedStatementCacheSizeMiB=0
spring.r2dbc.username=${SUPABASE_DB_USERNAME}
spring.r2dbc.password=${SUPABASE_DB_PASSWORD}


# ========== CONNECTION POOL ==========
spring.r2dbc.pool.max-size=10
spring.r2dbc.pool.min-idle=1
spring.r2dbc.pool.initial-size=2
spring.r2dbc.pool.max-idle-time=60s
spring.r2dbc.pool.max-life-time=120s
spring.r2dbc.pool.max-acquire-time=30s
spring.r2dbc.pool.max-create-connection-time=30s
spring.r2dbc.pool.acquire-retry=3
spring.r2dbc.pool.validation-query=SELECT 1
spring.r2dbc.pool.max-validation-time=5s

# ========== SERVER & SHUTDOWN ==========
server.shutdown=graceful
server.netty.connection-timeout=30s
server.netty.idle-timeout=60s
server.netty.response-timeout=30s

spring.reactor.netty.shutdown-quiet-period=2s
spring.reactor.netty.shutdown-timeout=30s

# ========== FILE UPLOAD (WebFlux) ==========
spring.codec.max-in-memory-size=10MB
spring.webflux.multipart.max-in-memory-size=10MB

# ========== CORS ==========
cors.allowed-origins=https://ai-doc-frontend-ouqn.onrender.com,http://localhost:3000,http://localhost:5173

# ========== FLYWAY ==========
spring.flyway.url=${SUPABASE_DB_URL_FLYWAY}
spring.flyway.user=${SUPABASE_DB_USERNAME}
spring.flyway.password=${SUPABASE_DB_PASSWORD}
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true
spring.flyway.connect-retries=2
spring.flyway.init-sql=SET statement_timeout='30s'

# ========== JWT ==========
jwt.secret=${JWT_SECRET}
jwt.expiration=43200000

# ========== LOGGING ==========
logging.level.root=WARN
logging.level.com.haraldsson=INFO

# ========== APPLICATION SPECIFIC ==========
# Max antal samtidiga embedding-anrop
app.embedding.max-concurrent=2
app.embedding.timeout-seconds=30

# Chunk settings
app.chunk.size=800
app.chunk.overlap=150